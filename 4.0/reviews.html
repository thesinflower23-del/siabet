<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="assets/logo.png">
  <title>Reviews ¬∑ BestBuddies Pet Grooming</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/reviews.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <nav>
      <a class="logo" href="index.html">
        <img src="assets/logo.png" alt="BestBuddies logo" class="logo-mark">
        <div class="logo-text">
          <span class="logo-wordmark">BestBuddies Pet Grooming</span>
        </div>
      </a>
      <button class="menu-toggle" aria-label="Toggle menu">‚ò∞</button>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="services.html">Services</a></li>
        <li><a href="reviews.html" class="active">Reviews</a></li>
        <li><a href="policy.html">Policy</a></li>
        <li><a href="login.html">Login</a></li>
        <li><a href="booking.html" class="btn btn-primary" style="background:#000; color:#fff; border:2px solid #000;">Book Now</a></li>
      </ul>
    </nav>
    <div class="mobile-drawer-overlay"></div>
    <div class="mobile-drawer">
      <div class="mobile-drawer-header">
        <a class="logo" href="index.html" style="display:flex; align-items:center; gap:0.85rem;">
          <img src="assets/logo.png" alt="BestBuddies logo" class="logo-mark" style="width:48px; height:48px;">
          <div class="logo-text">
            <span class="logo-wordmark" style="font-size:1rem;">BestBuddies Pet Grooming</span>
          </div>
        </a>
        <button class="mobile-drawer-close" aria-label="Close menu">√ó</button>
      </div>
      <ul class="mobile-drawer-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="services.html">Services</a></li>
        <li><a href="reviews.html" class="active">Reviews</a></li>
        <li><a href="policy.html">Policy</a></li>
        <li><a href="login.html">Login</a></li>
        <li><a href="booking.html">Book Now</a></li>
      </ul>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="section hero" style="margin-top:2rem;">
        <p class="eyebrow" style="letter-spacing:0.3em;">Social proof</p>
        <h1>Real stories from fur parents</h1>
        <p>See why thousands of pet lovers trust BestBuddies for gentle, stylish grooming.</p>
        <div class="hero-buttons">
          <a href="#testimonials" class="btn btn-primary btn-lg" style="background:#000; color:#fff; border:2px solid #000;">View Testimonials</a>
          <a href="booking.html" class="btn btn-outline btn-lg" style="border:2px solid #000; color:#000;">Book an Appointment</a>
        </div>
      </section>

      <section id="testimonials" class="section">
        <h2 class="section-title">‚≠ê Customer Reviews</h2>
        <p style="text-align: center; color: var(--gray-600); margin-bottom: 1.5rem;">Real feedback from our happy fur parents</p>
        <div id="customerReviewsContainer" class="grid grid-3">
          <p class="empty-state">Loading reviews...</p>
        </div>
        <div style="margin-top:2rem;">
          <h3 style="margin-bottom:1rem;">üêæBefore & After Galleries</h3>
          <div style="display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:1rem;">
            <div style="font-size:0.95rem; color: var(--gray-700);">Curated transformations from our community</div>
            <div style="display:flex; gap:0.5rem; align-items:center;">
              <label for="reviewLimitSelect" style="font-size:0.9rem; color:var(--gray-600);">Show:</label>
              <select id="reviewLimitSelect" style="padding:0.4rem 0.6rem; border-radius:6px; border:1px solid #ddd; background:#fff;">
                <option value="3">3</option>
                <option value="6">6</option>
                <option value="9" selected>9</option>
                <option value="all">All</option>
              </select>
            </div>
          </div>
          <div id="publicReviewFeed" class="review-feed-grid">
            <p class="empty-state" style="margin:0;">Once admins upload before & after shots, they will appear here automatically.</p>
          </div>
        </div>
      </section>

      <section class="section" style="text-align:center;">
        <h2 class="section-title">Share your experience</h2>
        <p>Tag us @BestBuddies.pet or drop a review on Facebook to get featured.</p>
        <div style="display:flex; justify-content:center; gap:1rem; flex-wrap:wrap;">
          <a href="https://facebook.com" target="_blank" rel="noopener" class="btn btn-outline" style="border:2px solid #000; color:#000;">Leave a Facebook Review</a>
          <a href="booking.html" class="btn btn-primary" style="background:#000; color:#fff; border:2px solid #000;">Book Again</a>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 Yen's Pet Shop. All rights reserved.</p>
      <p style="margin-top: 0.5rem; font-size: 0.9rem;">üìû 0951 986 5882 | ‚úâÔ∏è yenspetshop@gmail.com</p>
    </div>
  </footer>

  <script type="module" src="js/firebase-config.js"></script>
  <script type="module" src="js/firebase-db.js"></script>
  <script src="js/main.js"></script>
  <script src="js/custom-alert.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
      // Load before/after gallery
      if (typeof renderCommunityReviewFeed === 'function') {
        await renderCommunityReviewFeed('publicReviewFeed', 9);
      }
      
      // Load customer text reviews
      await loadCustomerReviews();
    });
    
    async function loadCustomerReviews() {
      const container = document.getElementById('customerReviewsContainer');
      if (!container) return;
      
      try {
        let bookings = [];
        if (typeof getBookings === 'function') {
          bookings = await getBookings();
        }
        
        // Filter bookings with reviews and ratings
        const reviewedBookings = bookings
          .filter(b => b.review && b.review.trim() && b.rating && b.rating > 0)
          .sort((a, b) => (b.rating || 0) - (a.rating || 0)) // Sort by rating (highest first)
          .slice(0, 9); // Show top 9 reviews
        
        if (!reviewedBookings.length) {
          container.innerHTML = `
            <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
              <p style="color: var(--gray-500);">No reviews yet. Be the first to share your experience!</p>
            </div>
          `;
          return;
        }
        
        container.innerHTML = reviewedBookings.map(booking => {
          const stars = '‚≠ê'.repeat(booking.rating || 0);
          const emptyStars = '‚òÜ'.repeat(5 - (booking.rating || 0));
          const customerName = booking.customerName || 'Happy Customer';
          const petName = booking.petName || 'Pet';
          const packageName = booking.packageName || 'Grooming Service';
          
          return `
            <div class="card" style="border-left: 4px solid #f9a825;">
              <div class="card-body">
                <div style="margin-bottom: 0.5rem; font-size: 1.1rem;">${stars}${emptyStars}</div>
                <p style="font-style: italic; margin-bottom: 1rem; color: var(--gray-700);">"${escapeHtml(booking.review)}"</p>
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem;">
                  <p style="margin: 0; font-weight: 600; color: var(--gray-900);">- ${escapeHtml(customerName)}</p>
                  <span style="font-size: 0.8rem; color: var(--gray-500);">${escapeHtml(petName)} ¬∑ ${escapeHtml(packageName)}</span>
                </div>
              </div>
            </div>
          `;
        }).join('');
        
      } catch (e) {
        console.error('Failed to load customer reviews:', e);
        container.innerHTML = '<p class="empty-state">Failed to load reviews.</p>';
      }
    }
  </script>
</body>
</html>

